<!DOCTYPE html>
<html>
<head>
<title>Titolo Pagina</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
	integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="script"></script>
<link rel="stylesheet" href="style_js">
</head>
<body>

	<div class="foto_bg" style="background-image: url('background');">
		<nav class="navbar navbar-expand-lg navbar-light ">

			<a class="navbar-brand mt-2 logo"
				href="${pageContext.request.contextPath}"> <img class=""
				width="75px" height="75px" src="logo" alt="Logo">
				<p>
					<b>SIG</b>LOG
				</p>
			</a>


		</nav>
		<!-- Corpo Pagina -->
		<div class="container-fluid corpo">
			<div class="row">
				<div class="col"></div>
				<div class="centrale col-md-5 pt-2"
					style="background-image: url('centrale')">
					<table id="tabella"></table>
				</div>
				<div class="col"></div>
			</div>
		</div>
		<!-- Footbar -->
	</div>
	<footer class="footer bg-light mt-auto py-3"
		style="background-image: url('nav');">
		<div class="container text-center">
			<span class="text-muted">&copy; 2023 SigLog. Tutti i diritti
				riservati.</span>
		</div>
	</footer>
	<script type="text/javascript">
		async function get_utenti() {
		  const response = await fetch('api_rest/get_utenti');
		  const utenti = await response.json();
		  
		  return utenti;
		}
		
		async function popola_tabella()
		{
			const tabella = document.getElementById('tabella');

			
			const utenti = await get_utenti();
			
			console.log(utenti);
			// Popola la tabella con i dati
			for(const p of utenti){
			  const riga = document.createElement('tr');
			  riga.innerHTML = `
			    <td>${p.nome}</td>
			    <td>${p.cognome}</td>
			    <td>${p.email}</td>
			    <td><button class="modifica">Modifica</button></td>
			    <td><button class="elimina">Elimina</button></td>
			  `;
			  tabella.appendChild(riga);
			};
		}
		
		async function eliminaUtente(id) 
		{
		  try {
		    const response = await fetch(`api_rest/delete_utente?id=${id}`, {
		      method: 'DELETE',
		    });
		    const result = await response.json();
		    if (result.success) {
		      // l'utente Ã¨ stato eliminato con successo
		      console.log('Utente eliminato con successo.');
		      // aggiorna la tabella
		      await popola_tabella();
		    } else {
		      console.error(result.message);
		    }
		  } catch (error) {
		    console.error(error);
		  }
		}
		
	  	popola_tabella();
</script>
	<!-- js Bootstrap -->
	<script
		src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
		integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
		crossorigin="anonymous"></script>

</body>
</html>

